import{_ as I,c as n,a as s,n as E,h as a,j as T,e as S,g as k,d as w,k as N,t as c,w as V,b as i,F as R,v as j,r as u,o as D,f as p,u as M,i as C}from"./index-BKur0Xgs.js";import{P as U}from"./PasswordInput-BF-IHSw_.js";import{S as q}from"./SpinnerIcon-COW5J2MH.js";import{C as G,a as z}from"./CopyButton-DtZUir__.js";import{R as B}from"./RippleEffect-DuIf-iM_.js";import{A as H}from"./ActionButton-BkospYlS.js";import{L as J}from"./LogoutIcon-B_aD6lEL.js";const K={name:"RefreshIcon",props:{className:{type:String,default:"w-5 h-5"}}};function O(d,r,l,e,x,y){return a(),n("svg",{class:E(l.className),"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},r[0]||(r[0]=[s("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.651 7.65a7.131 7.131 0 0 0-12.68 3.15M18.001 4v4h-4m-7.652 8.35a7.13 7.13 0 0 0 12.68-3.15M6 20v-4h4"},null,-1)]),2)}const Q=I(K,[["render",O]]),W={name:"PrimaryButton",components:{RippleEffect:B,LogoutIcon:J},props:{variant:{type:String,required:!0,validator:d=>["danger","warning","primary","secondary"].includes(d)},text:{type:String,required:!0},title:{type:String,default:""},icon:{type:String,default:null},disabled:{type:Boolean,default:!1}},emits:["click"],computed:{buttonClasses(){const d={danger:"bg-red-100 text-red-700 border-red-300 hover:bg-red-200 hover:border-red-400 dark:bg-red-900/20 dark:text-red-400 dark:border-red-800 dark:hover:bg-red-900/30",warning:"bg-orange-100 text-orange-700 border-orange-300 hover:bg-orange-200 hover:border-orange-400 dark:bg-orange-900/20 dark:text-orange-400 dark:border-orange-800 dark:hover:bg-orange-900/30",primary:"bg-brand-100 text-brand-700 border-brand-300 hover:bg-brand-200 hover:border-brand-400 dark:bg-brand-900/20 dark:text-brand-400 dark:border-brand-800 dark:hover:bg-brand-900/30",secondary:"bg-gray-100 text-gray-700 border-gray-300 hover:bg-gray-200 hover:border-gray-400 dark:bg-gray-900/20 dark:text-gray-400 dark:border-gray-800 dark:hover:bg-gray-900/30"};return d[this.variant]||d.secondary},rippleColor(){const d={danger:"rgba(239, 68, 68, 0.3)",warning:"rgba(249, 115, 22, 0.3)",primary:"rgba(59, 130, 246, 0.3)",secondary:"rgba(107, 114, 128, 0.3)"};return d[this.variant]||d.secondary}}},X=["onMousedown","disabled","title"];function Y(d,r,l,e,x,y){const b=k("RippleEffect");return a(),T(b,{color:y.rippleColor},{default:S(({createRipple:m})=>[s("button",{onClick:r[0]||(r[0]=f=>d.$emit("click")),onMousedown:m,disabled:l.disabled,class:E(["relative px-4 py-2.5 rounded-lg transition-all duration-200 overflow-hidden shadow-sm hover:shadow-md border flex items-center justify-center font-medium text-sm",y.buttonClasses,{"opacity-50 cursor-not-allowed":l.disabled}]),title:l.title},[l.icon?(a(),T(N(l.icon),{key:0,className:"w-5 h-5 mr-2"})):w("",!0),s("span",null,c(l.text),1)],42,X)]),_:1},8,["color"])}const Z=I(W,[["render",Y]]),$={name:"Profile",components:{PasswordInput:U,SpinnerIcon:q,CheckIcon:z,RefreshIcon:Q,CopyButton:G,RippleEffect:B,ActionButton:H,PrimaryButton:Z},setup(){const d=M(),r=u({currentPassword:"",newPassword:"",confirmPassword:""}),l=u(!1),e=u(""),x=u(""),y=u(""),b=u(""),m=u(!1),f=u(""),g=u([]),h=u(!1);D(async()=>{if(!p.isAuthenticated()){d.push("/login");return}await t(),await v()});const L=async()=>{if(e.value="",x.value="",r.value.newPassword!==r.value.confirmPassword){e.value="New passwords do not match";return}if(r.value.newPassword.length<6){e.value="New password must be at least 6 characters long";return}l.value=!0;try{const o=await p.changePassword(r.value.currentPassword,r.value.newPassword);o.success?(x.value="Password changed successfully",r.value={currentPassword:"",newPassword:"",confirmPassword:""}):e.value=o.message||"Failed to change password"}catch(o){e.value=o.message||"Failed to change password"}finally{l.value=!1}},A=async()=>{f.value="",m.value=!0;try{const o=await p.generateApiToken();o.success?(y.value=o.data.token,b.value=o.data.expires_at):f.value=o.message||"Failed to generate API token"}catch(o){f.value=o.message||"Failed to generate API token"}finally{m.value=!1}},v=async()=>{try{const o=await p.getCurrentApiToken();o.success&&o.data&&(y.value=o.data.token,b.value=o.data.expires_at)}catch(o){console.error("Failed to load API token:",o)}},t=async()=>{h.value=!0;try{const o=await p.getSessions();o.success&&(g.value=o.data||[])}catch(o){console.error("Failed to load sessions:",o)}finally{h.value=!1}};return{passwordForm:r,passwordLoading:l,passwordError:e,passwordSuccess:x,currentApiToken:y,apiTokenExpiry:b,tokenLoading:m,tokenError:f,sessions:g,sessionsLoading:h,changePassword:L,generateApiToken:A,loadApiToken:v,loadSessions:t,revokeSession:async o=>{try{(await p.revokeSession(o)).success&&(g.value=g.value.filter(F=>F.id!==o))}catch(P){console.error("Failed to revoke session:",P)}},revokeAllSessions:async()=>{try{(await p.revokeAllSessions()).success&&(g.value=g.value.filter(P=>P.is_current))}catch(o){console.error("Failed to revoke all sessions:",o)}},handleCurrentSessionLogout:async()=>{try{await p.logout(),d.push("/login")}catch(o){console.error("Logout error:",o),d.push("/login")}},formatDate:o=>o?new Date(o).toLocaleString():"Unknown"}}},ee={class:"max-w-4xl mx-auto space-y-8"},re={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"},oe={key:0,class:"p-4 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"},se={class:"text-sm text-red-700 dark:text-red-400"},te={key:1,class:"p-4 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800"},ae={class:"text-sm text-green-700 dark:text-green-400"},ne=["disabled","onClick","onTouchstart"],de={key:0,class:"flex items-center"},ie={key:1,class:"flex items-center"},le={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"},ce={class:"flex items-center justify-between mb-4"},ge=["onClick","onTouchstart","disabled"],ue={key:0,class:"flex items-center"},be={key:1,class:"flex items-center"},me={key:0,class:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 mb-4"},ke={class:"flex items-center justify-between mb-2"},we={class:"text-sm text-gray-900 dark:text-white font-mono break-all"},ye={class:"text-xs text-gray-500 dark:text-gray-400 mt-2"},pe={key:1,class:"p-4 rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 mb-4"},fe={class:"text-sm text-red-700 dark:text-red-400"},xe={class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6"},he={class:"flex items-center justify-between mb-4"},ve={class:"flex items-center space-x-3"},_e=["onClick","onTouchstart","disabled"],Pe={key:0},Ce={key:1},Se={key:0,class:"space-y-3"},Le={class:"flex-1"},Ae={class:"mb-1"},Te={class:"text-sm font-medium text-gray-900 dark:text-white"},Ie={class:"text-xs text-gray-500 dark:text-gray-400 flex items-center space-x-2"},Ee={key:0,class:"inline-flex items-center justify-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400 whitespace-nowrap flex-shrink-0"},Be={key:0,class:"flex-shrink-0"},Fe={key:1,class:"flex-shrink-0"},Ne={key:1,class:"text-center py-8"},Ve={key:2,class:"text-center py-8"};function Re(d,r,l,e,x,y){const b=k("PasswordInput"),m=k("SpinnerIcon"),f=k("CheckIcon"),g=k("RippleEffect"),h=k("RefreshIcon"),L=k("CopyButton"),A=k("PrimaryButton"),v=k("ActionButton");return a(),n("div",ee,[s("div",re,[r[6]||(r[6]=s("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-4"},"Change Password",-1)),s("form",{onSubmit:r[3]||(r[3]=V((...t)=>e.changePassword&&e.changePassword(...t),["prevent"])),class:"space-y-4"},[i(b,{id:"currentPassword",modelValue:e.passwordForm.currentPassword,"onUpdate:modelValue":r[0]||(r[0]=t=>e.passwordForm.currentPassword=t),label:"Current Password",placeholder:"Enter your current password",required:"",disabled:e.passwordLoading},null,8,["modelValue","disabled"]),i(b,{id:"newPassword",modelValue:e.passwordForm.newPassword,"onUpdate:modelValue":r[1]||(r[1]=t=>e.passwordForm.newPassword=t),label:"New Password",placeholder:"Enter your new password",required:"",disabled:e.passwordLoading},null,8,["modelValue","disabled"]),i(b,{id:"confirmPassword",modelValue:e.passwordForm.confirmPassword,"onUpdate:modelValue":r[2]||(r[2]=t=>e.passwordForm.confirmPassword=t),label:"Confirm New Password",placeholder:"Confirm your new password",required:"",disabled:e.passwordLoading},null,8,["modelValue","disabled"]),e.passwordError?(a(),n("div",oe,[s("p",se,c(e.passwordError),1)])):w("",!0),e.passwordSuccess?(a(),n("div",te,[s("p",ae,c(e.passwordSuccess),1)])):w("",!0),i(g,{disabled:e.passwordLoading,color:"rgba(255, 255, 255, 0.3)"},{default:S(({createRipple:t})=>[s("button",{type:"submit",disabled:e.passwordLoading,onClick:t,onTouchstart:t,class:"bg-brand-600 hover:bg-brand-700 disabled:bg-gray-400 text-white font-medium py-3 px-6 rounded-lg transition-all transform hover:scale-[1.02] disabled:scale-100 disabled:cursor-not-allowed"},[e.passwordLoading?(a(),n("span",de,[i(m),r[4]||(r[4]=C(" Changing Password... "))])):(a(),n("span",ie,[i(f,{className:"w-4 h-4 mr-2"}),r[5]||(r[5]=C(" Change Password "))]))],40,ne)]),_:1},8,["disabled"])],32)]),s("div",le,[s("div",ce,[r[8]||(r[8]=s("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white"},"API Token",-1)),i(g,{disabled:e.tokenLoading,color:"rgba(255, 255, 255, 0.3)"},{default:S(({createRipple:t})=>[s("button",{onClick:_=>{t(_),e.generateApiToken()},onTouchstart:t,disabled:e.tokenLoading,class:E([e.currentApiToken?"bg-brand-600 hover:bg-brand-700":"bg-green-600 hover:bg-green-700","disabled:bg-gray-400 text-white font-medium py-2 px-4 rounded-lg transition-all text-sm"])},[e.tokenLoading?(a(),n("span",ue,[i(m),r[7]||(r[7]=C(" Generating... "))])):(a(),n("span",be,[e.currentApiToken?(a(),T(h,{key:0,className:"w-4 h-4 mr-2"})):w("",!0),C(" "+c(e.currentApiToken?"Regenerate Token":"Generate New Token"),1)]))],42,ge)]),_:1},8,["disabled"])]),r[10]||(r[10]=s("p",{class:"text-gray-600 dark:text-gray-400 mb-4"}," API tokens allow you to authenticate with the API. Tokens expire after 365 days. ",-1)),e.currentApiToken?(a(),n("div",me,[s("div",ke,[r[9]||(r[9]=s("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Current API Token:",-1)),i(L,{text:e.currentApiToken},null,8,["text"])]),s("code",we,c(e.currentApiToken),1),s("p",ye," Expires: "+c(e.formatDate(e.apiTokenExpiry)),1)])):w("",!0),e.tokenError?(a(),n("div",pe,[s("p",fe,c(e.tokenError),1)])):w("",!0)]),s("div",xe,[s("div",he,[r[11]||(r[11]=s("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white"},"Active Sessions",-1)),s("div",ve,[i(A,{variant:"warning",text:"Sign out all other devices",icon:"LogoutIcon",disabled:e.sessionsLoading||e.sessions.length<=1,onClick:e.revokeAllSessions},null,8,["disabled","onClick"]),i(g,{disabled:e.sessionsLoading,color:"rgba(37, 99, 235, 0.3)"},{default:S(({createRipple:t})=>[s("button",{onClick:_=>{t(_),e.loadSessions()},onTouchstart:t,disabled:e.sessionsLoading,class:"text-brand-600 dark:text-brand-400 hover:text-brand-700 dark:hover:text-brand-300 text-sm"},[e.sessionsLoading?(a(),n("span",Pe,"Loading...")):(a(),n("span",Ce,"Refresh"))],40,_e)]),_:1},8,["disabled"])])]),r[14]||(r[14]=s("p",{class:"text-gray-600 dark:text-gray-400 mb-4"}," Manage your active login sessions across different devices and browsers. ",-1)),e.sessions.length>0?(a(),n("div",Se,[(a(!0),n(R,null,j(e.sessions,t=>(a(),n("div",{key:t.id,class:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 flex items-center justify-between"},[s("div",Le,[s("div",Ae,[s("span",Te,c(t.user_agent||"Unknown Browser"),1)]),s("p",Ie,[s("span",null," IP: "+c(t.ip_address||"Unknown")+" • Last active: "+c(e.formatDate(t.updated_at))+" • Expires: "+c(e.formatDate(t.expires_at)),1),t.is_current?(a(),n("span",Ee," Current Session ")):w("",!0)])]),t.is_current?(a(),n("div",Be,[i(v,{variant:"danger",title:"Sign out (current session)",icon:"LogoutIcon",onClick:e.handleCurrentSessionLogout},null,8,["onClick"])])):(a(),n("div",Fe,[i(v,{variant:"danger",title:"Sign out session",icon:"LogoutIcon",onClick:_=>e.revokeSession(t.id)},null,8,["onClick"])]))]))),128))])):e.sessionsLoading?w("",!0):(a(),n("div",Ne,r[12]||(r[12]=[s("p",{class:"text-gray-500 dark:text-gray-400"},"No active sessions found",-1)]))),e.sessionsLoading?(a(),n("div",Ve,[i(m),r[13]||(r[13]=s("p",{class:"text-gray-500 dark:text-gray-400 mt-2"},"Loading sessions...",-1))])):w("",!0)])])}const Oe=I($,[["render",Re]]);export{Oe as default};
