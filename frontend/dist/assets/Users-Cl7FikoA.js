import{_ as Z,c as y,a as r,i as T,n as B,t as C,h as i,j as S,k as me,r as u,m as A,x as le,o as ie,e as q,f as U,g as _,w as ge,d as b,b as D,y as X,F as Q,v as Y,z as oe,A as fe}from"./index-Cd4aCzMT.js";import{B as ye,C as ve}from"./BriefcaseIcon-DIaF9aNM.js";import{U as de}from"./UserIcon-gtZ1h6Kj.js";import{S as ce}from"./SpinnerIcon-S0w2zb7Y.js";import{A as be,I as pe,D as xe,E as he}from"./ActionButton-D5FjZzzV.js";import{B as we,M as ke,C as _e,a as Ce,T as Pe}from"./BaseCheckbox-BqjZXePN.js";import{A as Ue,g as Se}from"./avatarHelper-ilIufXxn.js";import{B as Ee}from"./BaseInput-Dz1YLLEC.js";import{P as Be}from"./PasswordInput-pY15jIao.js";import"./RippleEffect-2iBhaxqA.js";import"./LogoutIcon-B8Ef0TvF.js";const Fe={name:"StatusBadge",props:{status:{type:String,required:!0,validator:d=>["active","disabled","blocked"].includes(d)}},computed:{statusConfig(){const d={active:{text:"Active",badgeClass:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",dotClass:"bg-green-500"},disabled:{text:"Disabled",badgeClass:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300",dotClass:"bg-gray-500"},blocked:{text:"Blocked",badgeClass:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400",dotClass:"bg-red-500"}};return d[this.status]||d.disabled},displayText(){return this.statusConfig.text},badgeClasses(){return this.statusConfig.badgeClass},dotClasses(){return this.statusConfig.dotClass}}};function Ie(d,s,E,e,p,l){return i(),y("span",{class:B([l.badgeClasses,"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium transition-colors duration-200"])},[r("span",{class:B([l.dotClasses,"w-1.5 h-1.5 mr-1.5 rounded-full"])},null,2),T(" "+C(l.displayText),1)],2)}const De=Z(Fe,[["render",Ie]]),Re={name:"RoleBadge",components:{BriefcaseIcon:ye,UserIcon:de},props:{role:{type:[String,Object],required:!1,default:null}},computed:{roleName(){return this.role?typeof this.role=="string"?this.role:this.role.name||this.role.role_name:null},displayName(){return this.role?typeof this.role=="string"?this.role:this.role.display_name||this.role.role_display_name||this.role.name||this.role.role_name||"Unknown Role":"No Role"},roleConfig(){const d=this.roleName,s={admin:{badgeClass:"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400",iconClass:"w-3.5 h-3.5",icon:"BriefcaseIcon"},customer:{badgeClass:"bg-brand-100 text-brand-800 dark:bg-brand-900/20 dark:text-brand-400",iconClass:"w-3 h-3",icon:"UserIcon"},user:{badgeClass:"bg-brand-100 text-brand-800 dark:bg-brand-900/20 dark:text-brand-400",iconClass:"w-3 h-3",icon:"UserIcon"},default:{badgeClass:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400",iconClass:"w-3 h-3",icon:"UserIcon"}};return s[d]||s.default},displayText(){return this.displayName},badgeClasses(){return this.roleConfig.badgeClass},iconClasses(){return this.roleConfig.iconClass},roleIcon(){return this.roleConfig.icon}}};function Ve(d,s,E,e,p,l){return i(),y("span",{class:B([l.badgeClasses,"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium transition-colors duration-200"])},[(i(),S(me(l.roleIcon),{className:l.iconClasses,class:"mr-1"},null,8,["className"])),T(" "+C(l.displayText),1)],2)}const Ne=Z(Re,[["render",Ve]]),Ae={name:"UserModal",components:{ModalInterface:ke,BaseInput:Ee,BaseCheckbox:we,PasswordInput:Be,SpinnerIcon:ce},props:{show:{type:Boolean,default:!1},user:{type:Object,default:null}},emits:["close","saved"],setup(d,{emit:s}){const E=u(!1),e=u([]),p=u([]),l=u({}),x=u({}),h=u({}),F=u(!1),m=u({name:"",email:"",password:"",role_id:"",status:"active"}),w=A(()=>!!d.user),o=u(null),f=u(!1),R=u(!1),O=u(!1),V=u(!1),n=u(null),z=A(()=>{var a;return w.value&&o.value&&((a=d.user)==null?void 0:a.id)===o.value.id}),M=A(()=>{const a=m.value.name.trim()&&m.value.email.trim(),t=w.value?!0:m.value.password.trim();return a&&t}),$=A(()=>{if(!m.value.role_id)return"";const a=p.value.find(t=>t.id===m.value.role_id);return a?a.display_name:""}),I=A(()=>[...new Set(e.value.map(t=>t.category).filter(Boolean))].sort()),ee=a=>a==null?e.value.filter(t=>!t.category||t.category===""):e.value.filter(t=>t.category===a),G=a=>!!x.value[a],se=(a,t)=>{z.value||!t&&G(a)||(l.value={...l.value,[a]:t})},J=async()=>{try{const a=await U.get("/permissions/all");if(a.success){e.value=a.data||[];const t={};e.value.forEach(g=>{t[g.id]=!1}),l.value=t}}catch(a){console.error("Failed to load permissions:",a)}},H=async()=>{try{const a=await U.get("/roles/assignable");if(a.success&&(p.value=a.data.roles,!w.value&&!m.value.role_id)){const t=p.value.find(g=>g.name==="customer");t&&(m.value.role_id=t.id)}}catch(a){console.error("Failed to load roles:",a)}},re=async()=>{var a;if(!(!w.value||!((a=d.user)!=null&&a.id)))try{const t=await U.get(`/users/${d.user.id}/can-edit`);t.success&&(n.value=t.data,V.value=t.data.has_more_permissions)}catch(t){console.error("Failed to check user edit permissions:",t),V.value=!1}},K=async a=>{if(!a){x.value={};return}try{const t=await U.get(`/roles/${a}`);if(t.success&&t.data.permissions){const g={};t.data.permissions.forEach(v=>{g[v.id]=!0}),x.value=g;const P={...l.value};t.data.permissions.forEach(v=>{P[v.id]=!0}),l.value=P}}catch(t){console.error("Failed to load role permissions:",t)}},te=async()=>{var a;if((a=d.user)!=null&&a.id)try{const t=await U.get(`/users/${d.user.id}/permissions`);if(t.success){ae.value=t.data.directPermissions.map(v=>v.id);const g={};t.data.rolePermissions.forEach(v=>{g[v.id]=!0}),x.value=g;const P={};e.value.forEach(v=>{const N=ae.value.includes(v.id),L=g[v.id];P[v.id]=N||L}),l.value=P}}catch(t){console.error("Failed to load user permissions:",t)}},W=()=>{if(m.value={name:"",email:"",password:"",role_id:"",status:"active"},h.value={},F.value=!1,x.value={},e.value.length>0){const a={};e.value.forEach(t=>{a[t.id]=!1}),l.value=a}},c=()=>{d.user&&(m.value={name:d.user.name||"",email:d.user.email||"",password:"",role_id:d.user.role_id||"",status:d.user.status||"active"})},k=()=>{W(),s("close")},j=async()=>{if(M.value){E.value=!0,h.value={};try{const a={name:m.value.name,email:m.value.email,role_id:m.value.role_id||null,status:m.value.status};(m.value.password||!w.value)&&(a.password=m.value.password);let t;if(w.value?t=await U.put(`/users/${d.user.id}`,a):t=await U.post("/users",a),t.success){if(w.value){const g=Object.keys(l.value).filter(v=>{const N=l.value[v],L=x.value[v];return N&&!L}),P=await U.put(`/users/${d.user.id}/permissions`,{permissions:g});P.success||console.error("Failed to update permissions:",P)}else if(Object.values(l.value).some(g=>g)){const g=Object.keys(l.value).filter(v=>l.value[v]),P=await U.put(`/users/${t.data.user.id}/permissions`,{permissions:g});P.success||console.error("Failed to set permissions:",P)}s("saved",t.data),k()}else if(t.errors)h.value=t.errors;else throw new Error(t.message||"Failed to save user")}catch(a){console.error("Error saving user:",a),h.value={general:a.message||"Failed to save user"}}finally{E.value=!1}}};le(()=>m.value.role_id,async(a,t)=>{var v;if(!a||a===t)return;const g={};w.value&&((v=d.user)!=null&&v.id)&&(await ue()).forEach(L=>{g[L]=!0});const P={};e.value.forEach(N=>{P[N.id]=!1}),l.value=P,await K(a),Object.keys(g).forEach(N=>{l.value[N]=!0})});const ae=u([]),ue=()=>ae.value,ne=async()=>{try{const a=await U.get("/auth/profile");if(a.success){o.value=a.data.user;const t=await U.get(`/users/${a.data.user.id}/permissions`);t.success&&(f.value=t.data.permissions.some(g=>g.name==="user_role_assign"),R.value=t.data.permissions.some(g=>g.name==="user_permissions_view"),O.value=t.data.permissions.some(g=>g.name==="user_permissions_edit"))}}catch(a){console.error("Failed to load current user:",a)}};return le(()=>[d.show,d.user],async([a,t])=>{a?(await Promise.all([J(),H(),ne()]),c(),t!=null&&t.id&&w.value?await Promise.all([te(),re()]):m.value.role_id&&await K(m.value.role_id)):(W(),V.value=!1,n.value=null)},{immediate:!0,deep:!0}),ie(async()=>{d.show&&(await Promise.all([J(),H(),ne()]),c())}),{loading:E,permissions:e,roles:p,selectedPermissions:l,rolePermissions:x,errors:h,form:m,showPasswordField:F,isEditing:w,isFormValid:M,isEditingSelf:z,canAssignRoles:f,canViewUserPermissions:R,canEditUserPermissions:O,roleDropdownDisabled:V,permissionCheckResult:n,selectedRoleName:$,permissionCategories:I,getPermissionsByCategory:ee,isPermissionFromRole:G,updatePermission:se,handleClose:k,handleSubmit:j}}},Me={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Te={key:0},Oe={class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"},je={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},qe=["disabled"],ze=["value"],Le={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},Qe=["disabled"],Ye={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},Ge={key:1},Je={key:0,class:"mb-3 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg"},He={class:"text-sm text-blue-800 dark:text-blue-200"},Ke={key:1,class:"mb-3 p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg"},We={key:2,class:"mb-3 p-3 bg-gray-50 dark:bg-gray-900/20 border border-gray-200 dark:border-gray-800 rounded-lg"},Xe={class:"space-y-4 max-h-48 overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-lg p-5"},Ze={class:"text-sm font-medium text-gray-700 dark:text-gray-300 capitalize border-b border-gray-200 dark:border-gray-700 pb-2"},$e={class:"grid grid-cols-1 lg:grid-cols-2 gap-3"},es={key:0,class:"space-y-3"},ss={class:"grid grid-cols-1 lg:grid-cols-2 gap-3"},rs={class:"flex justify-end space-x-3"},ts=["disabled"];function as(d,s,E,e,p,l){const x=_("BaseInput"),h=_("PasswordInput"),F=_("BaseCheckbox"),m=_("SpinnerIcon"),w=_("ModalInterface");return i(),S(w,{show:E.show,title:e.isEditing?"Edit User":"Create User",subtitle:e.isEditing?"Modify user settings, role and permissions":"Create a new user with role and permissions",size:"xl",onClose:e.handleClose},{footer:q(()=>[r("div",rs,[r("button",{type:"button",onClick:s[7]||(s[7]=(...o)=>e.handleClose&&e.handleClose(...o)),class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 transition-colors"}," Cancel "),r("button",{onClick:s[8]||(s[8]=(...o)=>e.handleSubmit&&e.handleSubmit(...o)),disabled:!e.isFormValid||e.loading,class:"px-4 py-2 text-sm font-medium text-white bg-brand-600 border border-transparent rounded-lg hover:bg-brand-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center"},[e.loading?(i(),S(m,{key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4"})):b("",!0),T(" "+C(e.isEditing?"Update User":"Create User"),1)],8,ts)])]),default:q(()=>[r("form",{onSubmit:s[6]||(s[6]=ge((...o)=>e.handleSubmit&&e.handleSubmit(...o),["prevent"])),class:"space-y-5"},[r("div",Me,[r("div",null,[s[9]||(s[9]=r("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"}," Name * ",-1)),D(x,{modelValue:e.form.name,"onUpdate:modelValue":s[0]||(s[0]=o=>e.form.name=o),type:"text",placeholder:"e.g., John Doe",error:e.errors.name,required:""},null,8,["modelValue","error"])]),r("div",null,[s[10]||(s[10]=r("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"}," Email * ",-1)),D(x,{modelValue:e.form.email,"onUpdate:modelValue":s[1]||(s[1]=o=>e.form.email=o),type:"email",placeholder:"e.g., john@example.com",error:e.errors.email,autocomplete:"new-email",required:""},null,8,["modelValue","error"])])]),!e.isEditing||e.showPasswordField?(i(),y("div",Te,[r("label",Oe,C(e.isEditing?"New Password":"Password")+" * ",1),D(h,{modelValue:e.form.password,"onUpdate:modelValue":s[2]||(s[2]=o=>e.form.password=o),placeholder:e.isEditing?"Enter new password to change":"Enter password",error:e.errors.password,required:!e.isEditing,autocomplete:"new-password"},null,8,["modelValue","placeholder","error","required"]),e.isEditing&&!e.showPasswordField?(i(),y("button",{key:0,type:"button",onClick:s[3]||(s[3]=o=>e.showPasswordField=!0),class:"mt-2 text-sm text-brand-600 dark:text-brand-400 hover:text-brand-700 dark:hover:text-brand-300"}," Change Password ")):b("",!0)])):b("",!0),r("div",je,[r("div",null,[s[11]||(s[11]=r("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"}," Role ",-1)),X(r("select",{"onUpdate:modelValue":s[4]||(s[4]=o=>e.form.role_id=o),disabled:e.isEditingSelf||!e.canAssignRoles||e.roleDropdownDisabled,class:B(["w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-700 dark:text-white transition-colors",[e.errors.role_id?"border-red-300 focus:border-red-500 focus:ring-red-500":"",e.isEditingSelf||!e.canAssignRoles||e.roleDropdownDisabled?"opacity-60 cursor-not-allowed":""]])},[(i(!0),y(Q,null,Y(e.roles,o=>(i(),y("option",{key:o.id,value:o.id},C(o.display_name||o.name),9,ze))),128))],10,qe),[[oe,e.form.role_id]]),e.errors.role_id?(i(),y("p",Le,C(e.errors.role_id),1)):b("",!0)]),r("div",null,[s[13]||(s[13]=r("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"}," Status ",-1)),X(r("select",{"onUpdate:modelValue":s[5]||(s[5]=o=>e.form.status=o),disabled:e.isEditingSelf,class:B(["w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-700 dark:text-white transition-colors",[e.errors.status?"border-red-300 focus:border-red-500 focus:ring-red-500":"",e.isEditingSelf?"opacity-60 cursor-not-allowed":""]])},s[12]||(s[12]=[r("option",{value:"active"},"Active",-1),r("option",{value:"disabled"},"Disabled",-1),r("option",{value:"blocked"},"Blocked",-1)]),10,Qe),[[oe,e.form.status]]),e.errors.status?(i(),y("p",Ye,C(e.errors.status),1)):b("",!0)])]),e.permissions.length>0?(i(),y("div",Ge,[s[18]||(s[18]=r("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-3"}," Permissions ",-1)),e.form.role_id?(i(),y("div",Je,[r("p",He,[r("strong",null,C(e.selectedRoleName)+" Role:",1),s[14]||(s[14]=T(" Some permissions are inherited from the selected role and cannot be removed. You can only add additional permissions. "))])])):b("",!0),e.isEditingSelf?(i(),y("div",Ke,s[15]||(s[15]=[r("p",{class:"text-sm text-amber-800 dark:text-amber-200"},[r("strong",null,"Note:"),T(" You cannot modify your own permissions. Contact an administrator if you need permission changes. ")],-1)]))):b("",!0),!e.canEditUserPermissions&&!e.isEditingSelf?(i(),y("div",We,s[16]||(s[16]=[r("p",{class:"text-sm text-gray-800 dark:text-gray-200"},[r("strong",null,"Read-only:"),T(" You can view permissions but cannot modify them. Contact an administrator if you need permission management access. ")],-1)]))):b("",!0),r("div",Xe,[(i(!0),y(Q,null,Y(e.permissionCategories,o=>(i(),y("div",{key:o,class:"space-y-3"},[r("h4",Ze,C(o.replace("_"," ")),1),r("div",$e,[(i(!0),y(Q,null,Y(e.getPermissionsByCategory(o),f=>(i(),S(F,{key:f.id,id:`permission-${f.id}`,modelValue:e.selectedPermissions[f.id],"onUpdate:modelValue":R=>e.updatePermission(f.id,R),label:f.display_name,help:f.description,disabled:e.isPermissionFromRole(f.id)||e.isEditingSelf||!e.canEditUserPermissions,class:B(e.isPermissionFromRole(f.id)||e.isEditingSelf||!e.canEditUserPermissions?"opacity-60":"")},null,8,["id","modelValue","onUpdate:modelValue","label","help","disabled","class"]))),128))])]))),128)),e.getPermissionsByCategory(null).length>0?(i(),y("div",es,[s[17]||(s[17]=r("h4",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 border-b border-gray-200 dark:border-gray-700 pb-2"}," Other ",-1)),r("div",ss,[(i(!0),y(Q,null,Y(e.getPermissionsByCategory(null),o=>(i(),S(F,{key:o.id,id:`permission-${o.id}`,modelValue:e.selectedPermissions[o.id],"onUpdate:modelValue":f=>e.updatePermission(o.id,f),label:o.display_name,help:o.description,disabled:e.isPermissionFromRole(o.id)||e.isEditingSelf||!e.canEditUserPermissions,class:B(e.isPermissionFromRole(o.id)||e.isEditingSelf||!e.canEditUserPermissions?"opacity-60":"")},null,8,["id","modelValue","onUpdate:modelValue","label","help","disabled","class"]))),128))])])):b("",!0)])])):b("",!0)],32)]),_:1},8,["show","title","subtitle","onClose"])}const os=Z(Ae,[["render",as]]),ns={name:"Users",components:{StatusBadge:De,RoleBadge:Ne,UserIcon:de,SpinnerIcon:ce,EditIcon:he,DeleteIcon:xe,ImpersonateIcon:pe,ActionButton:be,TablePagination:Pe,BaseTable:Ce,ChevronDownIcon:ve,CreateButton:_e,Avatar:Ue,UserModal:os},setup(){const d=u([]),s=u(!1),E=u(null),e=u(null),p=u(""),l=u(""),x=u(10),h=u(!1),F=u(!1),m=u(null),w=u(null),o=u("created_at"),f=u("desc");let R=null;const O=()=>{clearTimeout(R),R=setTimeout(()=>{I()},300)},V=A(()=>p.value.trim()||l.value),n=A(()=>V.value?"No users found":"No users created yet"),z=A(()=>p.value.trim()&&l.value?`No users match your search "${p.value}" with status "${l.value}".`:p.value.trim()?`No users match your search "${p.value}".`:l.value?`No users found with status "${l.value}".`:"Get started by creating your first user account."),M=()=>{p.value="",l.value="",I()},$=c=>{x.value=c,I(1)},I=async(c=1)=>{s.value=!0,E.value=null;try{const k=new URLSearchParams({page:c.toString(),limit:x.value.toString(),sortBy:o.value,sortOrder:f.value});p.value.trim()&&k.append("search",p.value.trim()),l.value&&k.append("status",l.value);const j=await U.get(`/users?${k}`);if(j.success)d.value=j.data.users,e.value=j.data.pagination;else throw new Error(j.message||"Failed to load users")}catch(k){console.error("Error loading users:",k),E.value=k.message||"Failed to load users",d.value=[],e.value=null}finally{s.value=!1}},ee=c=>{o.value===c?f.value=f.value==="asc"?"desc":"asc":(o.value=c,f.value="asc"),I()},G=c=>{c>=1&&c<=e.value.totalPages&&I(c)},se=()=>{h.value=!1,F.value=!1,m.value=null},J=async c=>{await I()},H=async()=>{try{const c=await U.get("/auth/profile");c.success&&(w.value=c.data.user)}catch(c){console.error("Failed to load current user:",c)}},re=c=>new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),K=c=>{m.value=c,F.value=!0},te=async c=>{if(confirm(`Are you sure you want to delete user "${c.name}"? This action cannot be undone.`))try{const k=await U.delete(`/users/${c.id}`);k.success?await I():alert(k.message||"Failed to delete user")}catch(k){console.error("Error deleting user:",k),alert("Failed to delete user")}},W=c=>{console.log("Impersonate user:",c)};return ie(async()=>{await Promise.all([I(),H()])}),{users:d,loading:s,error:E,pagination:e,searchQuery:p,statusFilter:l,perPage:x,sortField:o,sortOrder:f,showCreateUser:h,showEditUser:F,selectedUser:m,hasActiveFilters:V,emptyStateTitle:n,emptyStateMessage:z,loadUsers:I,sortBy:ee,changePage:G,handlePerPageChange:$,formatDate:re,debouncedSearch:O,clearFilters:M,closeModal:se,handleUserSaved:J,editUser:K,deleteUser:te,impersonateUser:W,getAvatarImage:Se}}},ls={class:"space-y-6"},is={class:"flex flex-col sm:flex-row sm:items-center sm:justify-end gap-4"},ds={class:"flex flex-col sm:flex-row gap-3"},cs={class:"relative"},us={class:"relative"},ms={class:"flex items-center space-x-1"},gs={class:"flex items-center space-x-1"},fs={class:"flex items-center space-x-1"},ys={class:"flex items-center space-x-1"},vs={class:"flex items-center space-x-1"},bs={class:"px-6 py-4 whitespace-nowrap"},ps={class:"flex items-center"},xs={class:"mr-3"},hs={class:"text-sm font-medium text-gray-900 dark:text-white"},ws={class:"text-sm text-gray-500 dark:text-gray-400"},ks={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},_s={class:"px-6 py-4 whitespace-nowrap"},Cs={class:"px-6 py-4 whitespace-nowrap"},Ps={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},Us={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ss={class:"flex items-center space-x-2"},Es={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},Bs={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"};function Fs(d,s,E,e,p,l){const x=_("CreateButton"),h=_("ChevronDownIcon"),F=_("Avatar"),m=_("RoleBadge"),w=_("StatusBadge"),o=_("ActionButton"),f=_("UserIcon"),R=_("BaseTable"),O=_("TablePagination"),V=_("UserModal");return i(),y("div",ls,[r("div",is,[r("div",ds,[r("div",cs,[s[11]||(s[11]=r("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[r("svg",{class:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),X(r("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>e.searchQuery=n),type:"text",placeholder:"Search users...",class:"w-full sm:w-64 pl-10 pr-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-700 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",onInput:s[1]||(s[1]=(...n)=>e.debouncedSearch&&e.debouncedSearch(...n))},null,544),[[fe,e.searchQuery]])]),r("div",us,[X(r("select",{"onUpdate:modelValue":s[2]||(s[2]=n=>e.statusFilter=n),class:"w-full sm:w-auto pl-3 pr-8 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-700 dark:text-white appearance-none bg-white dark:bg-gray-700 transition-colors cursor-pointer",onChange:s[3]||(s[3]=(...n)=>e.loadUsers&&e.loadUsers(...n))},s[12]||(s[12]=[r("option",{value:""},"All Status",-1),r("option",{value:"active"},"Active",-1),r("option",{value:"disabled"},"Disabled",-1),r("option",{value:"blocked"},"Blocked",-1)]),544),[[oe,e.statusFilter]]),s[13]||(s[13]=r("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[r("svg",{class:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))]),D(x,{onClick:s[4]||(s[4]=n=>e.showCreateUser=!0)},{default:q(()=>s[14]||(s[14]=[T(" Create User ")])),_:1,__:[14]})])]),D(R,{data:e.users,loading:e.loading,error:e.error,"loading-text":"Loading users...","error-title":"Failed to load users",onRetry:e.loadUsers},{header:q(()=>[r("tr",null,[r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600",onClick:s[5]||(s[5]=n=>e.sortBy("name"))},[r("div",ms,[s[15]||(s[15]=r("span",null,"User",-1)),e.sortField==="name"?(i(),S(h,{key:0,class:B([{"transform rotate-180":e.sortOrder==="asc"},"w-4 h-4 transition-transform duration-200"])},null,8,["class"])):b("",!0)])]),r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600",onClick:s[6]||(s[6]=n=>e.sortBy("email"))},[r("div",gs,[s[16]||(s[16]=r("span",null,"Email",-1)),e.sortField==="email"?(i(),S(h,{key:0,class:B([{"transform rotate-180":e.sortOrder==="asc"},"w-4 h-4 transition-transform duration-200"])},null,8,["class"])):b("",!0)])]),r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600",onClick:s[7]||(s[7]=n=>e.sortBy("role_name"))},[r("div",fs,[s[17]||(s[17]=r("span",null,"Role",-1)),e.sortField==="role_name"?(i(),S(h,{key:0,class:B([{"transform rotate-180":e.sortOrder==="asc"},"w-4 h-4 transition-transform duration-200"])},null,8,["class"])):b("",!0)])]),r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600",onClick:s[8]||(s[8]=n=>e.sortBy("status"))},[r("div",ys,[s[18]||(s[18]=r("span",null,"Status",-1)),e.sortField==="status"?(i(),S(h,{key:0,class:B([{"transform rotate-180":e.sortOrder==="asc"},"w-4 h-4 transition-transform duration-200"])},null,8,["class"])):b("",!0)])]),r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600",onClick:s[9]||(s[9]=n=>e.sortBy("created_at"))},[r("div",vs,[s[19]||(s[19]=r("span",null,"Created",-1)),e.sortField==="created_at"?(i(),S(h,{key:0,class:B([{"transform rotate-180":e.sortOrder==="asc"},"w-4 h-4 transition-transform duration-200"])},null,8,["class"])):b("",!0)])]),s[20]||(s[20]=r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Actions ",-1))])]),body:q(()=>[(i(!0),y(Q,null,Y(e.users,(n,z)=>(i(),y("tr",{key:n.id,class:"odd:bg-gray-50 odd:dark:bg-gray-700 even:bg-white even:dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-600"},[r("td",bs,[r("div",ps,[r("div",xs,[D(F,{imageUrl:e.getAvatarImage(n.username||""),size:"md",alt:`${n.name} Avatar`},null,8,["imageUrl","alt"])]),r("div",null,[r("div",hs,C(n.name),1),r("div",ws,C(n.username||"No username"),1)])])]),r("td",ks,C(n.email),1),r("td",_s,[D(m,{role:n.role_name?{name:n.role_name,display_name:n.role_display_name}:null},null,8,["role"])]),r("td",Cs,[D(w,{status:n.status},null,8,["status"])]),r("td",Ps,C(e.formatDate(n.created_at)),1),r("td",Us,[r("div",Ss,[n.can_edit?(i(),S(o,{key:0,variant:"edit",title:"Edit user",icon:"EditIcon",onClick:M=>e.editUser(n)},null,8,["onClick"])):b("",!0),D(o,{variant:"impersonate",title:"Impersonate user",icon:"ImpersonateIcon",onClick:M=>e.impersonateUser(n)},null,8,["onClick"]),n.status==="disabled"?(i(),S(o,{key:1,variant:"delete",title:"Delete user (only available for disabled users)",icon:"DeleteIcon",onClick:M=>e.deleteUser(n)},null,8,["onClick"])):b("",!0)])])]))),128))]),empty:q(()=>[D(f,{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500"}),r("h3",Es,C(e.emptyStateTitle),1),r("p",Bs,C(e.emptyStateMessage),1),e.hasActiveFilters?(i(),y("button",{key:0,onClick:s[10]||(s[10]=(...n)=>e.clearFilters&&e.clearFilters(...n)),class:"mt-3 inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 transition-colors"}," Clear filters ")):b("",!0)]),_:1},8,["data","loading","error","onRetry"]),e.pagination?(i(),S(O,{key:0,pagination:e.pagination,"per-page":e.perPage,onPageChange:e.changePage,onPerPageChange:e.handlePerPageChange},null,8,["pagination","per-page","onPageChange","onPerPageChange"])):b("",!0),D(V,{show:e.showCreateUser||e.showEditUser,user:e.selectedUser,onClose:e.closeModal,onSaved:e.handleUserSaved},null,8,["show","user","onClose","onSaved"])])}const zs=Z(ns,[["render",Fs]]);export{zs as default};
