import{_ as Z,c as f,a as r,i as O,n as B,t as P,h as d,j as S,k as me,r as u,m as A,x as le,o as ie,e as z,f as U,g as C,w as ge,d as x,b as R,y as X,F as L,v as Q,z as oe,A as fe}from"./index-BKur0Xgs.js";import{B as ye,C as ve}from"./BriefcaseIcon-BwTl7y2u.js";import{U as de}from"./UserIcon-BCeKf0nM.js";import{S as ce}from"./SpinnerIcon-COW5J2MH.js";import{A as be,I as xe,D as he,E as pe}from"./ActionButton-BkospYlS.js";import{B as we,M as ke,C as _e,a as Ce,T as Pe}from"./BaseCheckbox-5Vcqpob-.js";import{A as Ue,g as Se}from"./avatarHelper-DHb4mgqs.js";import{B as Ee}from"./BaseInput-CKlsbFRp.js";import{P as Be}from"./PasswordInput-BF-IHSw_.js";import"./RippleEffect-DuIf-iM_.js";import"./LogoutIcon-B_aD6lEL.js";const Fe={name:"StatusBadge",props:{status:{type:String,required:!0,validator:n=>["active","disabled","blocked"].includes(n)}},computed:{statusConfig(){const n={active:{text:"Active",badgeClass:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",dotClass:"bg-green-500"},disabled:{text:"Disabled",badgeClass:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300",dotClass:"bg-gray-500"},blocked:{text:"Blocked",badgeClass:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400",dotClass:"bg-red-500"}};return n[this.status]||n.disabled},displayText(){return this.statusConfig.text},badgeClasses(){return this.statusConfig.badgeClass},dotClasses(){return this.statusConfig.dotClass}}};function Ie(n,s,E,e,v,i){return d(),f("span",{class:B([i.badgeClasses,"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium transition-colors duration-200"])},[r("span",{class:B([i.dotClasses,"w-1.5 h-1.5 mr-1.5 rounded-full"])},null,2),O(" "+P(i.displayText),1)],2)}const Re=Z(Fe,[["render",Ie]]),De={name:"RoleBadge",components:{BriefcaseIcon:ye,UserIcon:de},props:{role:{type:[String,Object],required:!1,default:null}},computed:{roleName(){return this.role?typeof this.role=="string"?this.role:this.role.name||this.role.role_name:null},displayName(){return this.role?typeof this.role=="string"?this.role:this.role.display_name||this.role.role_display_name||this.role.name||this.role.role_name||"Unknown Role":"No Role"},roleConfig(){const n=this.roleName,s={admin:{badgeClass:"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400",iconClass:"w-3.5 h-3.5",icon:"BriefcaseIcon"},customer:{badgeClass:"bg-brand-100 text-brand-800 dark:bg-brand-900/20 dark:text-brand-400",iconClass:"w-3 h-3",icon:"UserIcon"},user:{badgeClass:"bg-brand-100 text-brand-800 dark:bg-brand-900/20 dark:text-brand-400",iconClass:"w-3 h-3",icon:"UserIcon"},default:{badgeClass:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400",iconClass:"w-3 h-3",icon:"UserIcon"}};return s[n]||s.default},displayText(){return this.displayName},badgeClasses(){return this.roleConfig.badgeClass},iconClasses(){return this.roleConfig.iconClass},roleIcon(){return this.roleConfig.icon}}};function Ve(n,s,E,e,v,i){return d(),f("span",{class:B([i.badgeClasses,"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium transition-colors duration-200"])},[(d(),S(me(i.roleIcon),{className:i.iconClasses,class:"mr-1"},null,8,["className"])),O(" "+P(i.displayText),1)],2)}const Ne=Z(De,[["render",Ve]]),Ae={name:"UserModal",components:{ModalInterface:ke,BaseInput:Ee,BaseCheckbox:we,PasswordInput:Be,SpinnerIcon:ce},props:{show:{type:Boolean,default:!1},user:{type:Object,default:null}},emits:["close","saved"],setup(n,{emit:s}){const E=u(!1),e=u([]),v=u([]),i=u({}),p=u({}),w=u({}),F=u(!1),m=u({name:"",email:"",password:"",role_id:"",status:"active"}),k=A(()=>!!n.user),o=u(null),y=u(!1),D=u(!1),j=u(!1),V=u(!1),l=u(null),M=A(()=>{var a;return k.value&&o.value&&((a=n.user)==null?void 0:a.id)===o.value.id}),T=A(()=>{const a=m.value.name.trim()&&m.value.email.trim(),t=k.value?!0:m.value.password.trim();return a&&t}),$=A(()=>{if(!m.value.role_id)return"";const a=v.value.find(t=>t.id===m.value.role_id);return a?a.display_name:""}),I=A(()=>[...new Set(e.value.map(t=>t.category).filter(Boolean))].sort()),ee=a=>a==null?e.value.filter(t=>!t.category||t.category===""):e.value.filter(t=>t.category===a),G=a=>!!p.value[a],se=(a,t)=>{M.value||!t&&G(a)||(i.value={...i.value,[a]:t})},J=async()=>{try{const a=await U.get("/permissions/all");if(a.success){e.value=a.data||[];const t={};e.value.forEach(g=>{t[g.id]=!1}),i.value=t}}catch(a){console.error("Failed to load permissions:",a)}},H=async()=>{var a;try{const t=await U.get("/roles/assignable");if(t.success&&(v.value=t.data.roles,M.value&&((a=n.user)!=null&&a.role_id)&&!v.value.some(h=>h.id===n.user.role_id)&&n.user.role_name&&v.value.unshift({id:n.user.role_id,name:n.user.role_name,display_name:n.user.role_display_name||n.user.role_name}),!k.value&&!m.value.role_id)){const g=v.value.find(h=>h.name==="customer");g&&(m.value.role_id=g.id)}}catch(t){console.error("Failed to load roles:",t)}},re=async()=>{var a;if(!(!k.value||!((a=n.user)!=null&&a.id)))try{const t=await U.get(`/users/${n.user.id}/can-edit`);t.success&&(l.value=t.data,V.value=t.data.has_more_permissions)}catch(t){console.error("Failed to check user edit permissions:",t),V.value=!1}},K=async a=>{if(!a){p.value={};return}try{const t=await U.get(`/roles/${a}`);if(t.success&&t.data.permissions){const g={};t.data.permissions.forEach(b=>{g[b.id]=!0}),p.value=g;const h={...i.value};t.data.permissions.forEach(b=>{h[b.id]=!0}),i.value=h}}catch(t){console.error("Failed to load role permissions:",t)}},te=async()=>{var a;if((a=n.user)!=null&&a.id)try{const t=await U.get(`/users/${n.user.id}/permissions`);if(t.success){ae.value=t.data.directPermissions.map(b=>b.id);const g={};t.data.rolePermissions.forEach(b=>{g[b.id]=!0}),p.value=g;const h={};e.value.forEach(b=>{const N=ae.value.includes(b.id),Y=g[b.id];h[b.id]=N||Y}),i.value=h}}catch(t){console.error("Failed to load user permissions:",t)}},W=()=>{if(m.value={name:"",email:"",password:"",role_id:"",status:"active"},w.value={},F.value=!1,p.value={},e.value.length>0){const a={};e.value.forEach(t=>{a[t.id]=!1}),i.value=a}},c=()=>{n.user&&(m.value={name:n.user.name||"",email:n.user.email||"",password:"",role_id:n.user.role_id||"",status:n.user.status||"active"})},_=()=>{W(),s("close")},q=async()=>{if(T.value){E.value=!0,w.value={};try{const a={name:m.value.name,email:m.value.email};M.value||(a.role_id=m.value.role_id||null,a.status=m.value.status),(m.value.password||!k.value)&&(a.password=m.value.password);let t;if(k.value?t=await U.put(`/users/${n.user.id}`,a):t=await U.post("/users",a),t.success){if(k.value){const g=Object.keys(i.value).filter(b=>{const N=i.value[b],Y=p.value[b];return N&&!Y}),h=await U.put(`/users/${n.user.id}/permissions`,{permissions:g});h.success||console.error("Failed to update permissions:",h)}else if(Object.values(i.value).some(g=>g)){const g=Object.keys(i.value).filter(b=>i.value[b]),h=await U.put(`/users/${t.data.user.id}/permissions`,{permissions:g});h.success||console.error("Failed to set permissions:",h)}s("saved",t.data),_()}else if(t.errors)w.value=t.errors;else throw new Error(t.message||"Failed to save user")}catch(a){console.error("Error saving user:",a),w.value={general:a.message||"Failed to save user"}}finally{E.value=!1}}};le(()=>m.value.role_id,async(a,t)=>{var b;if(!a||a===t)return;const g={};k.value&&((b=n.user)!=null&&b.id)&&(await ue()).forEach(Y=>{g[Y]=!0});const h={};e.value.forEach(N=>{h[N.id]=!1}),i.value=h,await K(a),Object.keys(g).forEach(N=>{i.value[N]=!0})});const ae=u([]),ue=()=>ae.value,ne=async()=>{try{const a=await U.get("/auth/profile");if(a.success){o.value=a.data.user;const t=await U.get(`/users/${a.data.user.id}/permissions`);t.success&&(y.value=t.data.permissions.some(g=>g.name==="user_role_assign"),D.value=t.data.permissions.some(g=>g.name==="user_permissions_view"),j.value=t.data.permissions.some(g=>g.name==="user_permissions_edit"))}}catch(a){console.error("Failed to load current user:",a)}};return le(()=>[n.show,n.user],async([a,t])=>{a?(await Promise.all([J(),H(),ne()]),c(),t!=null&&t.id&&k.value?await Promise.all([te(),re()]):m.value.role_id&&await K(m.value.role_id)):(W(),V.value=!1,l.value=null)},{immediate:!0,deep:!0}),ie(async()=>{n.show&&(await Promise.all([J(),H(),ne()]),c())}),{loading:E,permissions:e,roles:v,selectedPermissions:i,rolePermissions:p,errors:w,form:m,showPasswordField:F,isEditing:k,isFormValid:T,isEditingSelf:M,canAssignRoles:y,canViewUserPermissions:D,canEditUserPermissions:j,roleDropdownDisabled:V,permissionCheckResult:l,selectedRoleName:$,permissionCategories:I,getPermissionsByCategory:ee,isPermissionFromRole:G,updatePermission:se,handleClose:_,handleSubmit:q}}},Me={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Te={key:0},Oe={class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"},je={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},qe=["disabled"],ze=["value"],Ye={key:0,class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Le={key:1,class:"mt-1 text-sm text-red-600 dark:text-red-400"},Qe=["disabled"],Ge={key:0,class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Je={key:1,class:"mt-1 text-sm text-red-600 dark:text-red-400"},He={key:1},Ke={key:0,class:"mb-3 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg"},We={class:"text-sm text-blue-800 dark:text-blue-200"},Xe={key:1,class:"mb-3 p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg"},Ze={key:2,class:"mb-3 p-3 bg-gray-50 dark:bg-gray-900/20 border border-gray-200 dark:border-gray-800 rounded-lg"},$e={class:"space-y-4 max-h-48 overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-lg p-5"},es={class:"text-sm font-medium text-gray-700 dark:text-gray-300 capitalize border-b border-gray-200 dark:border-gray-700 pb-2"},ss={class:"grid grid-cols-1 lg:grid-cols-2 gap-3"},rs={key:0,class:"space-y-3"},ts={class:"grid grid-cols-1 lg:grid-cols-2 gap-3"},as={class:"flex justify-end space-x-3"},os=["disabled"];function ns(n,s,E,e,v,i){const p=C("BaseInput"),w=C("PasswordInput"),F=C("BaseCheckbox"),m=C("SpinnerIcon"),k=C("ModalInterface");return d(),S(k,{show:E.show,title:e.isEditing?"Edit User":"Create User",subtitle:e.isEditing?"Modify user settings, role and permissions":"Create a new user with role and permissions",size:"xl",onClose:e.handleClose},{footer:z(()=>[r("div",as,[r("button",{type:"button",onClick:s[7]||(s[7]=(...o)=>e.handleClose&&e.handleClose(...o)),class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 transition-colors"}," Cancel "),r("button",{onClick:s[8]||(s[8]=(...o)=>e.handleSubmit&&e.handleSubmit(...o)),disabled:!e.isFormValid||e.loading,class:"px-4 py-2 text-sm font-medium text-white bg-brand-600 border border-transparent rounded-lg hover:bg-brand-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center"},[e.loading?(d(),S(m,{key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4"})):x("",!0),O(" "+P(e.isEditing?"Update User":"Create User"),1)],8,os)])]),default:z(()=>[r("form",{onSubmit:s[6]||(s[6]=ge((...o)=>e.handleSubmit&&e.handleSubmit(...o),["prevent"])),class:"space-y-5"},[r("div",Me,[r("div",null,[s[9]||(s[9]=r("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"}," Name * ",-1)),R(p,{modelValue:e.form.name,"onUpdate:modelValue":s[0]||(s[0]=o=>e.form.name=o),type:"text",placeholder:"e.g., John Doe",error:e.errors.name,required:""},null,8,["modelValue","error"])]),r("div",null,[s[10]||(s[10]=r("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"}," Email * ",-1)),R(p,{modelValue:e.form.email,"onUpdate:modelValue":s[1]||(s[1]=o=>e.form.email=o),type:"email",placeholder:"e.g., john@example.com",error:e.errors.email,autocomplete:"new-email",required:""},null,8,["modelValue","error"])])]),!e.isEditing||e.showPasswordField?(d(),f("div",Te,[r("label",Oe,P(e.isEditing?"New Password":"Password")+" * ",1),R(w,{modelValue:e.form.password,"onUpdate:modelValue":s[2]||(s[2]=o=>e.form.password=o),placeholder:e.isEditing?"Enter new password to change":"Enter password",error:e.errors.password,required:!e.isEditing,autocomplete:"new-password"},null,8,["modelValue","placeholder","error","required"]),e.isEditing&&!e.showPasswordField?(d(),f("button",{key:0,type:"button",onClick:s[3]||(s[3]=o=>e.showPasswordField=!0),class:"mt-2 text-sm text-brand-600 dark:text-brand-400 hover:text-brand-700 dark:hover:text-brand-300"}," Change Password ")):x("",!0)])):x("",!0),r("div",je,[r("div",null,[s[11]||(s[11]=r("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"}," Role ",-1)),X(r("select",{"onUpdate:modelValue":s[4]||(s[4]=o=>e.form.role_id=o),disabled:e.isEditingSelf||!e.canAssignRoles||e.roleDropdownDisabled,class:B(["w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-700 dark:text-white transition-colors",[e.errors.role_id?"border-red-300 focus:border-red-500 focus:ring-red-500":"",e.isEditingSelf||!e.canAssignRoles||e.roleDropdownDisabled?"opacity-60 cursor-not-allowed":""]])},[(d(!0),f(L,null,Q(e.roles,o=>(d(),f("option",{key:o.id,value:o.id},P(o.display_name||o.name),9,ze))),128))],10,qe),[[oe,e.form.role_id]]),e.isEditingSelf?(d(),f("p",Ye," You cannot change your own role ")):e.errors.role_id?(d(),f("p",Le,P(e.errors.role_id),1)):x("",!0)]),r("div",null,[s[13]||(s[13]=r("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"}," Status ",-1)),X(r("select",{"onUpdate:modelValue":s[5]||(s[5]=o=>e.form.status=o),disabled:e.isEditingSelf,class:B(["w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-700 dark:text-white transition-colors",[e.errors.status?"border-red-300 focus:border-red-500 focus:ring-red-500":"",e.isEditingSelf?"opacity-60 cursor-not-allowed":""]])},s[12]||(s[12]=[r("option",{value:"active"},"Active",-1),r("option",{value:"disabled"},"Disabled",-1),r("option",{value:"blocked"},"Blocked",-1)]),10,Qe),[[oe,e.form.status]]),e.isEditingSelf?(d(),f("p",Ge," You cannot change your own status ")):e.errors.status?(d(),f("p",Je,P(e.errors.status),1)):x("",!0)])]),e.permissions.length>0?(d(),f("div",He,[s[18]||(s[18]=r("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-3"}," Permissions ",-1)),e.form.role_id?(d(),f("div",Ke,[r("p",We,[r("strong",null,P(e.selectedRoleName)+" Role:",1),s[14]||(s[14]=O(" Some permissions are inherited from the selected role and cannot be removed. You can only add additional permissions. "))])])):x("",!0),e.isEditingSelf?(d(),f("div",Xe,s[15]||(s[15]=[r("p",{class:"text-sm text-amber-800 dark:text-amber-200"},[r("strong",null,"Note:"),O(" You cannot modify your own permissions. Contact an administrator if you need permission changes. ")],-1)]))):x("",!0),!e.canEditUserPermissions&&!e.isEditingSelf?(d(),f("div",Ze,s[16]||(s[16]=[r("p",{class:"text-sm text-gray-800 dark:text-gray-200"},[r("strong",null,"Read-only:"),O(" You can view permissions but cannot modify them. Contact an administrator if you need permission management access. ")],-1)]))):x("",!0),r("div",$e,[(d(!0),f(L,null,Q(e.permissionCategories,o=>(d(),f("div",{key:o,class:"space-y-3"},[r("h4",es,P(o.replace("_"," ")),1),r("div",ss,[(d(!0),f(L,null,Q(e.getPermissionsByCategory(o),y=>(d(),S(F,{key:y.id,id:`permission-${y.id}`,modelValue:e.selectedPermissions[y.id],"onUpdate:modelValue":D=>e.updatePermission(y.id,D),label:y.display_name,help:y.description,disabled:e.isPermissionFromRole(y.id)||e.isEditingSelf||!e.canEditUserPermissions,class:B(e.isPermissionFromRole(y.id)||e.isEditingSelf||!e.canEditUserPermissions?"opacity-60":"")},null,8,["id","modelValue","onUpdate:modelValue","label","help","disabled","class"]))),128))])]))),128)),e.getPermissionsByCategory(null).length>0?(d(),f("div",rs,[s[17]||(s[17]=r("h4",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 border-b border-gray-200 dark:border-gray-700 pb-2"}," Other ",-1)),r("div",ts,[(d(!0),f(L,null,Q(e.getPermissionsByCategory(null),o=>(d(),S(F,{key:o.id,id:`permission-${o.id}`,modelValue:e.selectedPermissions[o.id],"onUpdate:modelValue":y=>e.updatePermission(o.id,y),label:o.display_name,help:o.description,disabled:e.isPermissionFromRole(o.id)||e.isEditingSelf||!e.canEditUserPermissions,class:B(e.isPermissionFromRole(o.id)||e.isEditingSelf||!e.canEditUserPermissions?"opacity-60":"")},null,8,["id","modelValue","onUpdate:modelValue","label","help","disabled","class"]))),128))])])):x("",!0)])])):x("",!0)],32)]),_:1},8,["show","title","subtitle","onClose"])}const ls=Z(Ae,[["render",ns]]),is={name:"Users",components:{StatusBadge:Re,RoleBadge:Ne,UserIcon:de,SpinnerIcon:ce,EditIcon:pe,DeleteIcon:he,ImpersonateIcon:xe,ActionButton:be,TablePagination:Pe,BaseTable:Ce,ChevronDownIcon:ve,CreateButton:_e,Avatar:Ue,UserModal:ls},setup(){const n=u([]),s=u(!1),E=u(null),e=u(null),v=u(""),i=u(""),p=u(10),w=u(!1),F=u(!1),m=u(null),k=u(null),o=u("created_at"),y=u("desc");let D=null;const j=()=>{clearTimeout(D),D=setTimeout(()=>{I()},300)},V=A(()=>v.value.trim()||i.value),l=A(()=>V.value?"No users found":"No users created yet"),M=A(()=>v.value.trim()&&i.value?`No users match your search "${v.value}" with status "${i.value}".`:v.value.trim()?`No users match your search "${v.value}".`:i.value?`No users found with status "${i.value}".`:"Get started by creating your first user account."),T=()=>{v.value="",i.value="",I()},$=c=>{p.value=c,I(1)},I=async(c=1)=>{s.value=!0,E.value=null;try{const _=new URLSearchParams({page:c.toString(),limit:p.value.toString(),sortBy:o.value,sortOrder:y.value});v.value.trim()&&_.append("search",v.value.trim()),i.value&&_.append("status",i.value);const q=await U.get(`/users?${_}`);if(q.success)n.value=q.data.users,e.value=q.data.pagination;else throw new Error(q.message||"Failed to load users")}catch(_){console.error("Error loading users:",_),E.value=_.message||"Failed to load users",n.value=[],e.value=null}finally{s.value=!1}},ee=c=>{o.value===c?y.value=y.value==="asc"?"desc":"asc":(o.value=c,y.value="asc"),I()},G=c=>{c>=1&&c<=e.value.totalPages&&I(c)},se=()=>{w.value=!1,F.value=!1,m.value=null},J=async c=>{await I()},H=async()=>{try{const c=await U.get("/auth/profile");c.success&&(k.value=c.data.user)}catch(c){console.error("Failed to load current user:",c)}},re=c=>new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),K=c=>{m.value=c,F.value=!0},te=async c=>{if(confirm(`Are you sure you want to delete user "${c.name}"? This action cannot be undone.`))try{const _=await U.delete(`/users/${c.id}`);_.success?await I():alert(_.message||"Failed to delete user")}catch(_){console.error("Error deleting user:",_),alert("Failed to delete user")}},W=c=>{console.log("Impersonate user:",c)};return ie(async()=>{await Promise.all([I(),H()])}),{users:n,loading:s,error:E,pagination:e,searchQuery:v,statusFilter:i,perPage:p,sortField:o,sortOrder:y,showCreateUser:w,showEditUser:F,selectedUser:m,hasActiveFilters:V,emptyStateTitle:l,emptyStateMessage:M,loadUsers:I,sortBy:ee,changePage:G,handlePerPageChange:$,formatDate:re,debouncedSearch:j,clearFilters:T,closeModal:se,handleUserSaved:J,editUser:K,deleteUser:te,impersonateUser:W,getAvatarImage:Se}}},ds={class:"space-y-6"},cs={class:"flex flex-col sm:flex-row sm:items-center sm:justify-end gap-4"},us={class:"flex flex-col sm:flex-row gap-3"},ms={class:"relative"},gs={class:"relative"},fs={class:"flex items-center space-x-1"},ys={class:"flex items-center space-x-1"},vs={class:"flex items-center space-x-1"},bs={class:"flex items-center space-x-1"},xs={class:"flex items-center space-x-1"},hs={class:"px-6 py-4 whitespace-nowrap"},ps={class:"flex items-center"},ws={class:"mr-3"},ks={class:"text-sm font-medium text-gray-900 dark:text-white"},_s={class:"text-sm text-gray-500 dark:text-gray-400"},Cs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},Ps={class:"px-6 py-4 whitespace-nowrap"},Us={class:"px-6 py-4 whitespace-nowrap"},Ss={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},Es={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Bs={class:"flex items-center space-x-2"},Fs={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},Is={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"};function Rs(n,s,E,e,v,i){const p=C("CreateButton"),w=C("ChevronDownIcon"),F=C("Avatar"),m=C("RoleBadge"),k=C("StatusBadge"),o=C("ActionButton"),y=C("UserIcon"),D=C("BaseTable"),j=C("TablePagination"),V=C("UserModal");return d(),f("div",ds,[r("div",cs,[r("div",us,[r("div",ms,[s[11]||(s[11]=r("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[r("svg",{class:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),X(r("input",{"onUpdate:modelValue":s[0]||(s[0]=l=>e.searchQuery=l),type:"text",placeholder:"Search users...",class:"w-full sm:w-64 pl-10 pr-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-700 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",onInput:s[1]||(s[1]=(...l)=>e.debouncedSearch&&e.debouncedSearch(...l))},null,544),[[fe,e.searchQuery]])]),r("div",gs,[X(r("select",{"onUpdate:modelValue":s[2]||(s[2]=l=>e.statusFilter=l),class:"w-full sm:w-auto pl-3 pr-8 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-700 dark:text-white appearance-none bg-white dark:bg-gray-700 transition-colors cursor-pointer",onChange:s[3]||(s[3]=(...l)=>e.loadUsers&&e.loadUsers(...l))},s[12]||(s[12]=[r("option",{value:""},"All Status",-1),r("option",{value:"active"},"Active",-1),r("option",{value:"disabled"},"Disabled",-1),r("option",{value:"blocked"},"Blocked",-1)]),544),[[oe,e.statusFilter]]),s[13]||(s[13]=r("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[r("svg",{class:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))]),R(p,{onClick:s[4]||(s[4]=l=>e.showCreateUser=!0)},{default:z(()=>s[14]||(s[14]=[O(" Create User ")])),_:1,__:[14]})])]),R(D,{data:e.users,loading:e.loading,error:e.error,"loading-text":"Loading users...","error-title":"Failed to load users",onRetry:e.loadUsers},{header:z(()=>[r("tr",null,[r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600",onClick:s[5]||(s[5]=l=>e.sortBy("name"))},[r("div",fs,[s[15]||(s[15]=r("span",null,"User",-1)),e.sortField==="name"?(d(),S(w,{key:0,class:B([{"transform rotate-180":e.sortOrder==="asc"},"w-4 h-4 transition-transform duration-200"])},null,8,["class"])):x("",!0)])]),r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600",onClick:s[6]||(s[6]=l=>e.sortBy("email"))},[r("div",ys,[s[16]||(s[16]=r("span",null,"Email",-1)),e.sortField==="email"?(d(),S(w,{key:0,class:B([{"transform rotate-180":e.sortOrder==="asc"},"w-4 h-4 transition-transform duration-200"])},null,8,["class"])):x("",!0)])]),r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600",onClick:s[7]||(s[7]=l=>e.sortBy("role_name"))},[r("div",vs,[s[17]||(s[17]=r("span",null,"Role",-1)),e.sortField==="role_name"?(d(),S(w,{key:0,class:B([{"transform rotate-180":e.sortOrder==="asc"},"w-4 h-4 transition-transform duration-200"])},null,8,["class"])):x("",!0)])]),r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600",onClick:s[8]||(s[8]=l=>e.sortBy("status"))},[r("div",bs,[s[18]||(s[18]=r("span",null,"Status",-1)),e.sortField==="status"?(d(),S(w,{key:0,class:B([{"transform rotate-180":e.sortOrder==="asc"},"w-4 h-4 transition-transform duration-200"])},null,8,["class"])):x("",!0)])]),r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600",onClick:s[9]||(s[9]=l=>e.sortBy("created_at"))},[r("div",xs,[s[19]||(s[19]=r("span",null,"Created",-1)),e.sortField==="created_at"?(d(),S(w,{key:0,class:B([{"transform rotate-180":e.sortOrder==="asc"},"w-4 h-4 transition-transform duration-200"])},null,8,["class"])):x("",!0)])]),s[20]||(s[20]=r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Actions ",-1))])]),body:z(()=>[(d(!0),f(L,null,Q(e.users,(l,M)=>(d(),f("tr",{key:l.id,class:"odd:bg-gray-50 odd:dark:bg-gray-700 even:bg-white even:dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-600"},[r("td",hs,[r("div",ps,[r("div",ws,[R(F,{imageUrl:e.getAvatarImage(l.username||""),size:"md",alt:`${l.name} Avatar`},null,8,["imageUrl","alt"])]),r("div",null,[r("div",ks,P(l.name),1),r("div",_s,P(l.username||"No username"),1)])])]),r("td",Cs,P(l.email),1),r("td",Ps,[R(m,{role:l.role_name?{name:l.role_name,display_name:l.role_display_name}:null},null,8,["role"])]),r("td",Us,[R(k,{status:l.status},null,8,["status"])]),r("td",Ss,P(e.formatDate(l.created_at)),1),r("td",Es,[r("div",Bs,[l.can_edit?(d(),S(o,{key:0,variant:"edit",title:"Edit user",icon:"EditIcon",onClick:T=>e.editUser(l)},null,8,["onClick"])):x("",!0),R(o,{variant:"impersonate",title:"Impersonate user",icon:"ImpersonateIcon",onClick:T=>e.impersonateUser(l)},null,8,["onClick"]),l.status==="disabled"?(d(),S(o,{key:1,variant:"delete",title:"Delete user (only available for disabled users)",icon:"DeleteIcon",onClick:T=>e.deleteUser(l)},null,8,["onClick"])):x("",!0)])])]))),128))]),empty:z(()=>[R(y,{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500"}),r("h3",Fs,P(e.emptyStateTitle),1),r("p",Is,P(e.emptyStateMessage),1),e.hasActiveFilters?(d(),f("button",{key:0,onClick:s[10]||(s[10]=(...l)=>e.clearFilters&&e.clearFilters(...l)),class:"mt-3 inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 transition-colors"}," Clear filters ")):x("",!0)]),_:1},8,["data","loading","error","onRetry"]),e.pagination?(d(),S(j,{key:0,pagination:e.pagination,"per-page":e.perPage,onPageChange:e.changePage,onPerPageChange:e.handlePerPageChange},null,8,["pagination","per-page","onPageChange","onPerPageChange"])):x("",!0),R(V,{show:e.showCreateUser||e.showEditUser,user:e.selectedUser,onClose:e.closeModal,onSaved:e.handleUserSaved},null,8,["show","user","onClose","onSaved"])])}const Ls=Z(is,[["render",Rs]]);export{Ls as default};
