import{_ as W,c as y,a as r,i as M,n as B,t as C,h as i,j as S,k as ie,r as m,m as N,x as ae,o as oe,e as j,f as U,g as _,w as de,d as b,b as R,y as K,F as z,v as L,z as re,A as ce}from"./index-Dp99rAEB.js";import{B as ue,C as me}from"./BriefcaseIcon-C992-8GF.js";import{U as ne}from"./UserIcon-HPLXSr79.js";import{S as le}from"./SpinnerIcon-DzWrYR0L.js";import{A as ge,I as fe,D as ye,E as be}from"./ActionButton-DShL_DGw.js";import{B as ve,M as pe,C as xe,a as he,T as we}from"./BaseCheckbox-DEjJRfAJ.js";import{A as ke,g as _e}from"./avatarHelper-BWmc_Bc4.js";import{B as Ce}from"./BaseInput-CxIbUHHE.js";import{P as Pe}from"./PasswordInput-DLl7s_e7.js";import"./RippleEffect-WDp0XzxJ.js";import"./LogoutIcon-BEAykltr.js";const Ue={name:"StatusBadge",props:{status:{type:String,required:!0,validator:d=>["active","disabled","blocked"].includes(d)}},computed:{statusConfig(){const d={active:{text:"Active",badgeClass:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",dotClass:"bg-green-500"},disabled:{text:"Disabled",badgeClass:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300",dotClass:"bg-gray-500"},blocked:{text:"Blocked",badgeClass:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400",dotClass:"bg-red-500"}};return d[this.status]||d.disabled},displayText(){return this.statusConfig.text},badgeClasses(){return this.statusConfig.badgeClass},dotClasses(){return this.statusConfig.dotClass}}};function Se(d,s,E,e,v,n){return i(),y("span",{class:B([n.badgeClasses,"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium transition-colors duration-200"])},[r("span",{class:B([n.dotClasses,"w-1.5 h-1.5 mr-1.5 rounded-full"])},null,2),M(" "+C(n.displayText),1)],2)}const Ee=W(Ue,[["render",Se]]),Be={name:"RoleBadge",components:{BriefcaseIcon:ue,UserIcon:ne},props:{role:{type:[String,Object],required:!1,default:null}},computed:{roleName(){return this.role?typeof this.role=="string"?this.role:this.role.name||this.role.role_name:null},displayName(){return this.role?typeof this.role=="string"?this.role:this.role.display_name||this.role.role_display_name||this.role.name||this.role.role_name||"Unknown Role":"No Role"},roleConfig(){const d=this.roleName,s={admin:{badgeClass:"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400",iconClass:"w-3.5 h-3.5",icon:"BriefcaseIcon"},customer:{badgeClass:"bg-brand-100 text-brand-800 dark:bg-brand-900/20 dark:text-brand-400",iconClass:"w-3 h-3",icon:"UserIcon"},user:{badgeClass:"bg-brand-100 text-brand-800 dark:bg-brand-900/20 dark:text-brand-400",iconClass:"w-3 h-3",icon:"UserIcon"},default:{badgeClass:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400",iconClass:"w-3 h-3",icon:"UserIcon"}};return s[d]||s.default},displayText(){return this.displayName},badgeClasses(){return this.roleConfig.badgeClass},iconClasses(){return this.roleConfig.iconClass},roleIcon(){return this.roleConfig.icon}}};function Fe(d,s,E,e,v,n){return i(),y("span",{class:B([n.badgeClasses,"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium transition-colors duration-200"])},[(i(),S(ie(n.roleIcon),{className:n.iconClasses,class:"mr-1"},null,8,["className"])),M(" "+C(n.displayText),1)],2)}const Ie=W(Be,[["render",Fe]]),Re={name:"UserModal",components:{ModalInterface:pe,BaseInput:Ce,BaseCheckbox:ve,PasswordInput:Pe,SpinnerIcon:le},props:{show:{type:Boolean,default:!1},user:{type:Object,default:null}},emits:["close","saved"],setup(d,{emit:s}){const E=m(!1),e=m([]),v=m([]),n=m({}),x=m({}),h=m({}),F=m(!1),u=m({name:"",email:"",password:"",role_id:"",status:"active"}),w=N(()=>!!d.user),o=m(null),f=m(!1),V=m(!1),T=m(!1),D=m(!1),l=m(null),q=N(()=>{var a;return w.value&&o.value&&((a=d.user)==null?void 0:a.id)===o.value.id}),A=N(()=>{const a=u.value.name.trim()&&u.value.email.trim(),t=w.value?!0:u.value.password.trim();return a&&t}),X=N(()=>{if(!u.value.role_id)return"";const a=v.value.find(t=>t.id===u.value.role_id);return a?a.display_name:""}),I=N(()=>[...new Set(e.value.map(t=>t.category).filter(Boolean))].sort()),Z=a=>a==null?e.value.filter(t=>!t.category||t.category===""):e.value.filter(t=>t.category===a),Q=a=>!!x.value[a],$=(a,t)=>{q.value||!t&&Q(a)||(n.value={...n.value,[a]:t})},Y=async()=>{try{const a=await U.get("/permissions/all");if(a.success){e.value=a.data||[];const t={};e.value.forEach(g=>{t[g.id]=!1}),n.value=t}}catch(a){console.error("Failed to load permissions:",a)}},G=async()=>{try{const a=await U.get("/roles/assignable");if(a.success&&(v.value=a.data.roles,!w.value&&!u.value.role_id)){const t=v.value.find(g=>g.name==="customer");t&&(u.value.role_id=t.id)}}catch(a){console.error("Failed to load roles:",a)}},ee=async()=>{var a;if(!(!w.value||!((a=d.user)!=null&&a.id)))try{const t=await U.get(`/users/${d.user.id}/can-edit`);t.success&&(l.value=t.data,D.value=t.data.has_more_permissions)}catch(t){console.error("Failed to check user edit permissions:",t),D.value=!1}},J=async a=>{if(!a){x.value={};return}try{const t=await U.get(`/roles/${a}`);if(t.success&&t.data.permissions){const g={};t.data.permissions.forEach(p=>{g[p.id]=!0}),x.value=g;const P={...n.value};t.data.permissions.forEach(p=>{P[p.id]=!0}),n.value=P}}catch(t){console.error("Failed to load role permissions:",t)}},se=async()=>{var a;if((a=d.user)!=null&&a.id)try{const t=await U.get(`/users/${d.user.id}/permissions`);if(t.success){const g={...n.value};t.data.permissions.forEach(p=>{g.hasOwnProperty(p.id)&&(g[p.id]=!0)});const P={};t.data.rolePermissions.forEach(p=>{P[p.id]=!0}),x.value=P,n.value=g}}catch(t){console.error("Failed to load user permissions:",t)}},H=()=>{if(u.value={name:"",email:"",password:"",role_id:"",status:"active"},h.value={},F.value=!1,x.value={},e.value.length>0){const a={};e.value.forEach(t=>{a[t.id]=!1}),n.value=a}},c=()=>{d.user&&(u.value={name:d.user.name||"",email:d.user.email||"",password:"",role_id:d.user.role_id||"",status:d.user.status||"active"})},k=()=>{H(),s("close")},O=async()=>{if(A.value){E.value=!0,h.value={};try{const a={name:u.value.name,email:u.value.email,role_id:u.value.role_id||null,status:u.value.status};(u.value.password||!w.value)&&(a.password=u.value.password);let t;if(w.value?t=await U.put(`/users/${d.user.id}`,a):t=await U.post("/users",a),t.success){if(w.value){const g=Object.keys(n.value).filter(p=>n.value[p]),P=await U.put(`/users/${d.user.id}/permissions`,{permissions:g});P.success||console.error("Failed to update permissions:",P)}else if(Object.values(n.value).some(g=>g)){const g=Object.keys(n.value).filter(p=>n.value[p]),P=await U.put(`/users/${t.data.user.id}/permissions`,{permissions:g});P.success||console.error("Failed to set permissions:",P)}s("saved",t.data),k()}else if(t.errors)h.value=t.errors;else throw new Error(t.message||"Failed to save user")}catch(a){console.error("Error saving user:",a),h.value={general:a.message||"Failed to save user"}}finally{E.value=!1}}};ae(()=>u.value.role_id,async(a,t)=>{if(!a||a===t)return;const g={};w.value&&Object.keys(n.value).forEach(p=>{n.value[p]&&!x.value[p]&&(g[p]=!0)}),await J(a);const P={...n.value};Object.keys(g).forEach(p=>{P[p]=!0}),n.value=P});const te=async()=>{try{const a=await U.get("/auth/profile");if(a.success){o.value=a.data.user;const t=await U.get(`/users/${a.data.user.id}/permissions`);t.success&&(f.value=t.data.permissions.some(g=>g.name==="user_role_assign"),V.value=t.data.permissions.some(g=>g.name==="user_permissions_view"),T.value=t.data.permissions.some(g=>g.name==="user_permissions_edit"))}}catch(a){console.error("Failed to load current user:",a)}};return ae(()=>[d.show,d.user],async([a,t])=>{a?(await Promise.all([Y(),G(),te()]),c(),t!=null&&t.id&&w.value?await Promise.all([se(),ee()]):u.value.role_id&&await J(u.value.role_id)):(H(),D.value=!1,l.value=null)},{immediate:!0,deep:!0}),oe(async()=>{d.show&&(await Promise.all([Y(),G(),te()]),c())}),{loading:E,permissions:e,roles:v,selectedPermissions:n,rolePermissions:x,errors:h,form:u,showPasswordField:F,isEditing:w,isFormValid:A,isEditingSelf:q,canAssignRoles:f,canViewUserPermissions:V,canEditUserPermissions:T,roleDropdownDisabled:D,permissionCheckResult:l,selectedRoleName:X,permissionCategories:I,getPermissionsByCategory:Z,isPermissionFromRole:Q,updatePermission:$,handleClose:k,handleSubmit:O}}},Ve={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},De={key:0},Ne={class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"},Ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Me=["disabled"],Te=["value"],Oe={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},je=["disabled"],qe={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},ze={key:1},Le={key:0,class:"mb-3 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg"},Qe={class:"text-sm text-blue-800 dark:text-blue-200"},Ye={key:1,class:"mb-3 p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg"},Ge={key:2,class:"mb-3 p-3 bg-gray-50 dark:bg-gray-900/20 border border-gray-200 dark:border-gray-800 rounded-lg"},Je={class:"space-y-4 max-h-48 overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-lg p-5"},He={class:"text-sm font-medium text-gray-700 dark:text-gray-300 capitalize border-b border-gray-200 dark:border-gray-700 pb-2"},Ke={class:"grid grid-cols-1 lg:grid-cols-2 gap-3"},We={key:0,class:"space-y-3"},Xe={class:"grid grid-cols-1 lg:grid-cols-2 gap-3"},Ze={class:"flex justify-end space-x-3"},$e=["disabled"];function es(d,s,E,e,v,n){const x=_("BaseInput"),h=_("PasswordInput"),F=_("BaseCheckbox"),u=_("SpinnerIcon"),w=_("ModalInterface");return i(),S(w,{show:E.show,title:e.isEditing?"Edit User":"Create User",subtitle:e.isEditing?"Modify user settings, role and permissions":"Create a new user with role and permissions",size:"xl",onClose:e.handleClose},{footer:j(()=>[r("div",Ze,[r("button",{type:"button",onClick:s[7]||(s[7]=(...o)=>e.handleClose&&e.handleClose(...o)),class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 transition-colors"}," Cancel "),r("button",{onClick:s[8]||(s[8]=(...o)=>e.handleSubmit&&e.handleSubmit(...o)),disabled:!e.isFormValid||e.loading,class:"px-4 py-2 text-sm font-medium text-white bg-brand-600 border border-transparent rounded-lg hover:bg-brand-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center"},[e.loading?(i(),S(u,{key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4"})):b("",!0),M(" "+C(e.isEditing?"Update User":"Create User"),1)],8,$e)])]),default:j(()=>[r("form",{onSubmit:s[6]||(s[6]=de((...o)=>e.handleSubmit&&e.handleSubmit(...o),["prevent"])),class:"space-y-5"},[r("div",Ve,[r("div",null,[s[9]||(s[9]=r("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"}," Name * ",-1)),R(x,{modelValue:e.form.name,"onUpdate:modelValue":s[0]||(s[0]=o=>e.form.name=o),type:"text",placeholder:"e.g., John Doe",error:e.errors.name,required:""},null,8,["modelValue","error"])]),r("div",null,[s[10]||(s[10]=r("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"}," Email * ",-1)),R(x,{modelValue:e.form.email,"onUpdate:modelValue":s[1]||(s[1]=o=>e.form.email=o),type:"email",placeholder:"e.g., john@example.com",error:e.errors.email,autocomplete:"new-email",required:""},null,8,["modelValue","error"])])]),!e.isEditing||e.showPasswordField?(i(),y("div",De,[r("label",Ne,C(e.isEditing?"New Password":"Password")+" * ",1),R(h,{modelValue:e.form.password,"onUpdate:modelValue":s[2]||(s[2]=o=>e.form.password=o),placeholder:e.isEditing?"Enter new password to change":"Enter password",error:e.errors.password,required:!e.isEditing,autocomplete:"new-password"},null,8,["modelValue","placeholder","error","required"]),e.isEditing&&!e.showPasswordField?(i(),y("button",{key:0,type:"button",onClick:s[3]||(s[3]=o=>e.showPasswordField=!0),class:"mt-2 text-sm text-brand-600 dark:text-brand-400 hover:text-brand-700 dark:hover:text-brand-300"}," Change Password ")):b("",!0)])):b("",!0),r("div",Ae,[r("div",null,[s[11]||(s[11]=r("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"}," Role ",-1)),K(r("select",{"onUpdate:modelValue":s[4]||(s[4]=o=>e.form.role_id=o),disabled:e.isEditingSelf||!e.canAssignRoles||e.roleDropdownDisabled,class:B(["w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-700 dark:text-white transition-colors",[e.errors.role_id?"border-red-300 focus:border-red-500 focus:ring-red-500":"",e.isEditingSelf||!e.canAssignRoles||e.roleDropdownDisabled?"opacity-60 cursor-not-allowed":""]])},[(i(!0),y(z,null,L(e.roles,o=>(i(),y("option",{key:o.id,value:o.id},C(o.display_name||o.name),9,Te))),128))],10,Me),[[re,e.form.role_id]]),e.errors.role_id?(i(),y("p",Oe,C(e.errors.role_id),1)):b("",!0)]),r("div",null,[s[13]||(s[13]=r("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"}," Status ",-1)),K(r("select",{"onUpdate:modelValue":s[5]||(s[5]=o=>e.form.status=o),disabled:e.isEditingSelf,class:B(["w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-700 dark:text-white transition-colors",[e.errors.status?"border-red-300 focus:border-red-500 focus:ring-red-500":"",e.isEditingSelf?"opacity-60 cursor-not-allowed":""]])},s[12]||(s[12]=[r("option",{value:"active"},"Active",-1),r("option",{value:"disabled"},"Disabled",-1),r("option",{value:"blocked"},"Blocked",-1)]),10,je),[[re,e.form.status]]),e.errors.status?(i(),y("p",qe,C(e.errors.status),1)):b("",!0)])]),e.permissions.length>0?(i(),y("div",ze,[s[18]||(s[18]=r("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-3"}," Permissions ",-1)),e.form.role_id?(i(),y("div",Le,[r("p",Qe,[r("strong",null,C(e.selectedRoleName)+" Role:",1),s[14]||(s[14]=M(" Some permissions are inherited from the selected role and cannot be removed. You can only add additional permissions. "))])])):b("",!0),e.isEditingSelf?(i(),y("div",Ye,s[15]||(s[15]=[r("p",{class:"text-sm text-amber-800 dark:text-amber-200"},[r("strong",null,"Note:"),M(" You cannot modify your own permissions. Contact an administrator if you need permission changes. ")],-1)]))):b("",!0),!e.canEditUserPermissions&&!e.isEditingSelf?(i(),y("div",Ge,s[16]||(s[16]=[r("p",{class:"text-sm text-gray-800 dark:text-gray-200"},[r("strong",null,"Read-only:"),M(" You can view permissions but cannot modify them. Contact an administrator if you need permission management access. ")],-1)]))):b("",!0),r("div",Je,[(i(!0),y(z,null,L(e.permissionCategories,o=>(i(),y("div",{key:o,class:"space-y-3"},[r("h4",He,C(o.replace("_"," ")),1),r("div",Ke,[(i(!0),y(z,null,L(e.getPermissionsByCategory(o),f=>(i(),S(F,{key:f.id,id:`permission-${f.id}`,modelValue:e.selectedPermissions[f.id],"onUpdate:modelValue":V=>e.updatePermission(f.id,V),label:f.display_name,help:f.description,disabled:e.isPermissionFromRole(f.id)||e.isEditingSelf||!e.canEditUserPermissions,class:B(e.isPermissionFromRole(f.id)||e.isEditingSelf||!e.canEditUserPermissions?"opacity-60":"")},null,8,["id","modelValue","onUpdate:modelValue","label","help","disabled","class"]))),128))])]))),128)),e.getPermissionsByCategory(null).length>0?(i(),y("div",We,[s[17]||(s[17]=r("h4",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 border-b border-gray-200 dark:border-gray-700 pb-2"}," Other ",-1)),r("div",Xe,[(i(!0),y(z,null,L(e.getPermissionsByCategory(null),o=>(i(),S(F,{key:o.id,id:`permission-${o.id}`,modelValue:e.selectedPermissions[o.id],"onUpdate:modelValue":f=>e.updatePermission(o.id,f),label:o.display_name,help:o.description,disabled:e.isPermissionFromRole(o.id)||e.isEditingSelf||!e.canEditUserPermissions,class:B(e.isPermissionFromRole(o.id)||e.isEditingSelf||!e.canEditUserPermissions?"opacity-60":"")},null,8,["id","modelValue","onUpdate:modelValue","label","help","disabled","class"]))),128))])])):b("",!0)])])):b("",!0)],32)]),_:1},8,["show","title","subtitle","onClose"])}const ss=W(Re,[["render",es]]),rs={name:"Users",components:{StatusBadge:Ee,RoleBadge:Ie,UserIcon:ne,SpinnerIcon:le,EditIcon:be,DeleteIcon:ye,ImpersonateIcon:fe,ActionButton:ge,TablePagination:we,BaseTable:he,ChevronDownIcon:me,CreateButton:xe,Avatar:ke,UserModal:ss},setup(){const d=m([]),s=m(!1),E=m(null),e=m(null),v=m(""),n=m(""),x=m(10),h=m(!1),F=m(!1),u=m(null),w=m(null),o=m("created_at"),f=m("desc");let V=null;const T=()=>{clearTimeout(V),V=setTimeout(()=>{I()},300)},D=N(()=>v.value.trim()||n.value),l=N(()=>D.value?"No users found":"No users created yet"),q=N(()=>v.value.trim()&&n.value?`No users match your search "${v.value}" with status "${n.value}".`:v.value.trim()?`No users match your search "${v.value}".`:n.value?`No users found with status "${n.value}".`:"Get started by creating your first user account."),A=()=>{v.value="",n.value="",I()},X=c=>{x.value=c,I(1)},I=async(c=1)=>{s.value=!0,E.value=null;try{const k=new URLSearchParams({page:c.toString(),limit:x.value.toString(),sortBy:o.value,sortOrder:f.value});v.value.trim()&&k.append("search",v.value.trim()),n.value&&k.append("status",n.value);const O=await U.get(`/users?${k}`);if(O.success)d.value=O.data.users,e.value=O.data.pagination;else throw new Error(O.message||"Failed to load users")}catch(k){console.error("Error loading users:",k),E.value=k.message||"Failed to load users",d.value=[],e.value=null}finally{s.value=!1}},Z=c=>{o.value===c?f.value=f.value==="asc"?"desc":"asc":(o.value=c,f.value="asc"),I()},Q=c=>{c>=1&&c<=e.value.totalPages&&I(c)},$=()=>{h.value=!1,F.value=!1,u.value=null},Y=async c=>{await I()},G=async()=>{try{const c=await U.get("/auth/profile");c.success&&(w.value=c.data.user)}catch(c){console.error("Failed to load current user:",c)}},ee=c=>new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),J=c=>{u.value=c,F.value=!0},se=async c=>{if(confirm(`Are you sure you want to delete user "${c.name}"? This action cannot be undone.`))try{const k=await U.delete(`/users/${c.id}`);k.success?await I():alert(k.message||"Failed to delete user")}catch(k){console.error("Error deleting user:",k),alert("Failed to delete user")}},H=c=>{console.log("Impersonate user:",c)};return oe(async()=>{await Promise.all([I(),G()])}),{users:d,loading:s,error:E,pagination:e,searchQuery:v,statusFilter:n,perPage:x,sortField:o,sortOrder:f,showCreateUser:h,showEditUser:F,selectedUser:u,hasActiveFilters:D,emptyStateTitle:l,emptyStateMessage:q,loadUsers:I,sortBy:Z,changePage:Q,handlePerPageChange:X,formatDate:ee,debouncedSearch:T,clearFilters:A,closeModal:$,handleUserSaved:Y,editUser:J,deleteUser:se,impersonateUser:H,getAvatarImage:_e}}},ts={class:"space-y-6"},as={class:"flex flex-col sm:flex-row sm:items-center sm:justify-end gap-4"},os={class:"flex flex-col sm:flex-row gap-3"},ns={class:"relative"},ls={class:"relative"},is={class:"flex items-center space-x-1"},ds={class:"flex items-center space-x-1"},cs={class:"flex items-center space-x-1"},us={class:"flex items-center space-x-1"},ms={class:"flex items-center space-x-1"},gs={class:"px-6 py-4 whitespace-nowrap"},fs={class:"flex items-center"},ys={class:"mr-3"},bs={class:"text-sm font-medium text-gray-900 dark:text-white"},vs={class:"text-sm text-gray-500 dark:text-gray-400"},ps={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},xs={class:"px-6 py-4 whitespace-nowrap"},hs={class:"px-6 py-4 whitespace-nowrap"},ws={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},ks={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},_s={class:"flex items-center space-x-2"},Cs={class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},Ps={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"};function Us(d,s,E,e,v,n){const x=_("CreateButton"),h=_("ChevronDownIcon"),F=_("Avatar"),u=_("RoleBadge"),w=_("StatusBadge"),o=_("ActionButton"),f=_("UserIcon"),V=_("BaseTable"),T=_("TablePagination"),D=_("UserModal");return i(),y("div",ts,[r("div",as,[r("div",os,[r("div",ns,[s[11]||(s[11]=r("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[r("svg",{class:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),K(r("input",{"onUpdate:modelValue":s[0]||(s[0]=l=>e.searchQuery=l),type:"text",placeholder:"Search users...",class:"w-full sm:w-64 pl-10 pr-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-700 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors",onInput:s[1]||(s[1]=(...l)=>e.debouncedSearch&&e.debouncedSearch(...l))},null,544),[[ce,e.searchQuery]])]),r("div",ls,[K(r("select",{"onUpdate:modelValue":s[2]||(s[2]=l=>e.statusFilter=l),class:"w-full sm:w-auto pl-3 pr-8 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 dark:bg-gray-700 dark:text-white appearance-none bg-white dark:bg-gray-700 transition-colors cursor-pointer",onChange:s[3]||(s[3]=(...l)=>e.loadUsers&&e.loadUsers(...l))},s[12]||(s[12]=[r("option",{value:""},"All Status",-1),r("option",{value:"active"},"Active",-1),r("option",{value:"disabled"},"Disabled",-1),r("option",{value:"blocked"},"Blocked",-1)]),544),[[re,e.statusFilter]]),s[13]||(s[13]=r("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[r("svg",{class:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))]),R(x,{onClick:s[4]||(s[4]=l=>e.showCreateUser=!0)},{default:j(()=>s[14]||(s[14]=[M(" Create User ")])),_:1,__:[14]})])]),R(V,{data:e.users,loading:e.loading,error:e.error,"loading-text":"Loading users...","error-title":"Failed to load users",onRetry:e.loadUsers},{header:j(()=>[r("tr",null,[r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600",onClick:s[5]||(s[5]=l=>e.sortBy("name"))},[r("div",is,[s[15]||(s[15]=r("span",null,"User",-1)),e.sortField==="name"?(i(),S(h,{key:0,class:B([{"transform rotate-180":e.sortOrder==="asc"},"w-4 h-4 transition-transform duration-200"])},null,8,["class"])):b("",!0)])]),r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600",onClick:s[6]||(s[6]=l=>e.sortBy("email"))},[r("div",ds,[s[16]||(s[16]=r("span",null,"Email",-1)),e.sortField==="email"?(i(),S(h,{key:0,class:B([{"transform rotate-180":e.sortOrder==="asc"},"w-4 h-4 transition-transform duration-200"])},null,8,["class"])):b("",!0)])]),r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600",onClick:s[7]||(s[7]=l=>e.sortBy("role_name"))},[r("div",cs,[s[17]||(s[17]=r("span",null,"Role",-1)),e.sortField==="role_name"?(i(),S(h,{key:0,class:B([{"transform rotate-180":e.sortOrder==="asc"},"w-4 h-4 transition-transform duration-200"])},null,8,["class"])):b("",!0)])]),r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600",onClick:s[8]||(s[8]=l=>e.sortBy("status"))},[r("div",us,[s[18]||(s[18]=r("span",null,"Status",-1)),e.sortField==="status"?(i(),S(h,{key:0,class:B([{"transform rotate-180":e.sortOrder==="asc"},"w-4 h-4 transition-transform duration-200"])},null,8,["class"])):b("",!0)])]),r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600",onClick:s[9]||(s[9]=l=>e.sortBy("created_at"))},[r("div",ms,[s[19]||(s[19]=r("span",null,"Created",-1)),e.sortField==="created_at"?(i(),S(h,{key:0,class:B([{"transform rotate-180":e.sortOrder==="asc"},"w-4 h-4 transition-transform duration-200"])},null,8,["class"])):b("",!0)])]),s[20]||(s[20]=r("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Actions ",-1))])]),body:j(()=>[(i(!0),y(z,null,L(e.users,(l,q)=>(i(),y("tr",{key:l.id,class:"odd:bg-gray-50 odd:dark:bg-gray-700 even:bg-white even:dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-600"},[r("td",gs,[r("div",fs,[r("div",ys,[R(F,{imageUrl:e.getAvatarImage(l.username||""),size:"md",alt:`${l.name} Avatar`},null,8,["imageUrl","alt"])]),r("div",null,[r("div",bs,C(l.name),1),r("div",vs,C(l.username||"No username"),1)])])]),r("td",ps,C(l.email),1),r("td",xs,[R(u,{role:l.role_name?{name:l.role_name,display_name:l.role_display_name}:null},null,8,["role"])]),r("td",hs,[R(w,{status:l.status},null,8,["status"])]),r("td",ws,C(e.formatDate(l.created_at)),1),r("td",ks,[r("div",_s,[l.can_edit?(i(),S(o,{key:0,variant:"edit",title:"Edit user",icon:"EditIcon",onClick:A=>e.editUser(l)},null,8,["onClick"])):b("",!0),R(o,{variant:"impersonate",title:"Impersonate user",icon:"ImpersonateIcon",onClick:A=>e.impersonateUser(l)},null,8,["onClick"]),l.status==="disabled"?(i(),S(o,{key:1,variant:"delete",title:"Delete user (only available for disabled users)",icon:"DeleteIcon",onClick:A=>e.deleteUser(l)},null,8,["onClick"])):b("",!0)])])]))),128))]),empty:j(()=>[R(f,{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500"}),r("h3",Cs,C(e.emptyStateTitle),1),r("p",Ps,C(e.emptyStateMessage),1),e.hasActiveFilters?(i(),y("button",{key:0,onClick:s[10]||(s[10]=(...l)=>e.clearFilters&&e.clearFilters(...l)),class:"mt-3 inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-500 transition-colors"}," Clear filters ")):b("",!0)]),_:1},8,["data","loading","error","onRetry"]),e.pagination?(i(),S(T,{key:0,pagination:e.pagination,"per-page":e.perPage,onPageChange:e.changePage,onPerPageChange:e.handlePerPageChange},null,8,["pagination","per-page","onPageChange","onPerPageChange"])):b("",!0),R(D,{show:e.showCreateUser||e.showEditUser,user:e.selectedUser,onClose:e.closeModal,onSaved:e.handleUserSaved},null,8,["show","user","onClose","onSaved"])])}const Ts=W(rs,[["render",Us]]);export{Ts as default};
